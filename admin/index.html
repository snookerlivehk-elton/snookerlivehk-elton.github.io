<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Overview (Local Entry)</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 24px; }
      input, button { padding: 8px; font-size: 14px; }
      .row { margin-bottom: 12px; }
      pre { background: #f5f5f5; padding: 12px; overflow: auto; }
      a.btn { display:inline-block; padding:8px 12px; border:1px solid #888; border-radius:6px; text-decoration:none; }
      .note { color:#555; }
    </style>
  </head>
  <body>
    <h2>Admin 概覽（本地入口）</h2>
    <p class="note">此頁是本地輔助入口。按鈕會直接打開後端的 Admin 概覽頁（需要 token）。</p>

    <div class="row">
      <a class="btn" target="_blank" href="https://snookerhk.live/admin/overview?token=wwww5678">打開線上 Admin 概覽（snookerhk.live）</a>
    </div>

    <div class="row">
      <a class="btn" target="_blank" href="http://localhost:3000/admin/overview?token=wwww5678">打開本機 Admin 概覽（localhost:3000）</a>
    </div>

    <hr />
    <div class="row">
      <label>自訂 Backend URL：<input id="backendUrl" placeholder="例如 https://snookerhk.live" value="https://snookerhk.live" /></label>
    </div>
    <div class="row">
      <label>Admin Token：<input id="token" placeholder="wwww5678" value="wwww5678" /></label>
    </div>
    <div class="row">
      <button id="openBtn">在新分頁開啟 /admin/overview</button>
      <button id="fetchBtn">以 fetch 取得 /admin/overview JSON</button>
    </div>

    <div class="row">
      <strong>結果：</strong>
      <pre id="output">(尚未取得)</pre>
    </div>

    <p class="note">
      提示：若你用本地 `http://localhost:5173/admin` 嘗試以 fetch 讀取遠端後端，需後端允許 CORS（含 `http://localhost:5173`）。
      使用「在新分頁開啟」則不受 CORS 限制。
    </p>

    <script>
      const out = document.getElementById('output');
      function show(obj) {
        try { out.textContent = JSON.stringify(obj, null, 2); } catch { out.textContent = String(obj); }
      }
      function buildUrl(base, token) {
        const b = base.trim().replace(/\/$/, '');
        const t = encodeURIComponent(token.trim());
        return `${b}/admin/overview?token=${t}`;
      }
      document.getElementById('openBtn').onclick = () => {
        const url = buildUrl(document.getElementById('backendUrl').value, document.getElementById('token').value);
        window.open(url, '_blank');
      };
      document.getElementById('fetchBtn').onclick = async () => {
        const url = buildUrl(document.getElementById('backendUrl').value, document.getElementById('token').value);
        try {
          const res = await fetch(url, { method: 'GET' });
          const text = await res.text();
          try { show(JSON.parse(text)); } catch { show({ status: res.status, body: text }); }
        } catch (e) { show({ error: String(e) }); }
      };
    </script>
  </body>
  </html>